var Fe=Object.create,$=Object.defineProperty;var Ve=Object.getOwnPropertyDescriptor;var Ne=Object.getOwnPropertyNames;var He=Object.getPrototypeOf,Re=Object.prototype.hasOwnProperty;var B=n=>$(n,"__esModule",{value:!0});var b=(n,t)=>()=>(t||n((t={exports:{}}).exports,t),t.exports),We=(n,t)=>{for(var e in t)$(n,e,{get:t[e],enumerable:!0})},Be=(n,t,e)=>{if(t&&typeof t=="object"||typeof t=="function")for(let r of Ne(t))!Re.call(n,r)&&r!=="default"&&$(n,r,{get:()=>t[r],enumerable:!(e=Ve(t,r))||e.enumerable});return n},I=n=>Be(B($(n!=null?Fe(He(n)):{},"default",n&&n.__esModule&&"default"in n?{get:()=>n.default,enumerable:!0}:{value:n,enumerable:!0})),n);var re=b(V=>{"use strict";Object.defineProperty(V,"__esModule",{value:!0});var lt=require("os"),ct=require("child_process"),ut=require("fs"),ft=require("path");function L(n){return n&&typeof n=="object"&&"default"in n?n:{default:n}}var q=L(lt),D=L(ut),A=L(ft),dt=(n,t=1,e)=>{if(e={indent:" ",includeEmptyLines:!1,...e},typeof n!="string")throw new TypeError(`Expected \`input\` to be a \`string\`, got \`${typeof n}\``);if(typeof t!="number")throw new TypeError(`Expected \`count\` to be a \`number\`, got \`${typeof t}\``);if(typeof e.indent!="string")throw new TypeError(`Expected \`options.indent\` to be a \`string\`, got \`${typeof e.indent}\``);if(t===0)return n;let r=e.includeEmptyLines?/^/gm:/^(?!\s*$)/gm;return n.replace(r,e.indent.repeat(t))},U=/\s+at.*(?:\(|\s)(.*)\)?/,pt=/^(?:(?:(?:node|(?:internal\/[\w/]*|.*node_modules\/(?:babel-polyfill|pirates)\/.*)?\w+)\.js:\d+:\d+)|native)/,gt=typeof q.default.homedir=="undefined"?"":q.default.homedir(),ht=(n,t)=>(t=Object.assign({pretty:!1},t),n.replace(/\\/g,"/").split(`
`).filter(e=>{let r=e.match(U);if(r===null||!r[1])return!0;let a=r[1];return a.includes(".app/Contents/Resources/electron.asar")||a.includes(".app/Contents/Resources/default_app.asar")?!1:!pt.test(a)}).filter(e=>e.trim()!=="").map(e=>t.pretty?e.replace(U,(r,a)=>r.replace(a,a.replace(gt,"~"))):e).join(`
`)),mt=n=>n.replace(/\s+at .*aggregate-error\/index.js:\d+:\d+\)?/g,""),J=class extends Error{constructor(t){if(!Array.isArray(t))throw new TypeError(`Expected input to be an Array, got ${typeof t}`);t=[...t].map(r=>r instanceof Error?r:r!==null&&typeof r=="object"?Object.assign(new Error(r.message),r):new Error(r));let e=t.map(r=>typeof r.stack=="string"?mt(ht(r.stack)):String(r)).join(`
`);e=`
`+dt(e,4),super(e),this.name="AggregateError",Object.defineProperty(this,"_errors",{value:t})}*[Symbol.iterator](){for(let t of this._errors)yield t}},yt=J,vt=async(n,t,{concurrency:e=Infinity,stopOnError:r=!0}={})=>new Promise((a,i)=>{if(typeof t!="function")throw new TypeError("Mapper function is required");if(!((Number.isSafeInteger(e)||e===Infinity)&&e>=1))throw new TypeError(`Expected \`concurrency\` to be an integer from 1 and up or \`Infinity\`, got \`${e}\` (${typeof e})`);let o=[],l=[],u=n[Symbol.iterator](),s=!1,c=!1,f=0,d=0,p=()=>{if(s)return;let g=u.next(),h=d;if(d++,g.done){c=!0,f===0&&(!r&&l.length!==0?i(new yt(l)):a(o));return}f++,(async()=>{try{let y=await g.value;o[h]=await t(y,h),f--,p()}catch(y){r?(s=!0,i(y)):(l.push(y),f--,p())}})()};for(let g=0;g<e&&(p(),!c);g++);}),X=(n,t,e)=>new Promise((r,a)=>{if(e=Object.assign({concurrency:Infinity},e),typeof t!="function")throw new TypeError("Mapper function is required");let{concurrency:i}=e;if(!(typeof i=="number"&&i>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${i}\` (${typeof i})`);let o=[],l=n[Symbol.iterator](),u=!1,s=!1,c=0,f=0,d=()=>{if(u)return;let p=l.next(),g=f;if(f++,p.done){s=!0,c===0&&r(o);return}c++,Promise.resolve(p.value).then(h=>t(h,g)).then(h=>{o[g]=h,c--,d()},h=>{u=!0,a(h)})};for(let p=0;p<i&&(d(),!s);p++);}),Y=X,wt=X;Y.default=wt;var K=async(n,t,e)=>(await Y(n,(a,i)=>Promise.all([t(a,i),a]),e)).filter(a=>Boolean(a[0])).map(a=>a[1]),z=K,bt=K;z.default=bt;var E=typeof atom!="undefined",kt=typeof atom!="undefined"&&(atom.inDevMode()||atom.inSpecMode()),F="atom-package-deps.ignored";var Et=/["'&<>]/,Q=Pt;function Pt(n){var t=""+n,e=Et.exec(t);if(!e)return t;var r,a="",i=0,o=0;for(i=e.index;i<t.length;i++){switch(t.charCodeAt(i)){case 34:r="&quot;";break;case 38:r="&amp;";break;case 39:r="&#39;";break;case 60:r="&lt;";break;case 62:r="&gt;";break;default:continue}o!==i&&(a+=t.substring(o,i)),o=i+1,a+=r}return o!==i?a+t.substring(o,i):a}async function xt(n,t,e){let r=ct.spawn(n,t,e),a=new Promise((i,o)=>{let l={stdout:r.stdout?[]:null,stderr:r.stderr?[]:null};r.on("error",o),r.stdout&&r.stdout.on("data",function(u){l.stdout.push(u),e.handleStdout&&e.handleStdout(u)}),r.stderr&&r.stderr.on("data",function(u){l.stderr.push(u),e.handleStderr&&e.handleStderr(u)}),r.on("close",u=>{let s=null;l.stdout!=null&&(s=e.encoding===null||e.encoding==="buffer"?Buffer.concat(l.stdout):l.stdout.join(""));let c=null;l.stderr!=null&&(c=e.encoding===null||e.encoding==="buffer"?Buffer.concat(l.stderr):l.stderr.join("")),i({exitCode:u,stdout:s,stderr:c})})});return e.handleChildProcess(r),a}function _t(n,t,e){let r,a=xt(n,t,{...e,handleChildProcess(i){r=i}});return a.kill=function(i){return r.kill(i)},a}var St=function(t,e){for(var r=t.split("."),a=e.split("."),i=0;i<3;i++){var o=Number(r[i]),l=Number(a[i]);if(o>l)return 1;if(l>o)return-1;if(!isNaN(o)&&isNaN(l))return 1;if(isNaN(o)&&!isNaN(l))return-1}return 0};async function It(n){let t=atom.packages.getLoadedPackage(n),e=t&&t.metadata["package-deps"];return Array.isArray(e)?e:[]}async function Dt(n){return atom.packages.resolvePackagePath(n)}async function Tt(n){var t;let e=atom.packages.getLoadedPackage(n.name);return e==null?null:(t=e.metadata.version)!==null&&t!==void 0?t:null}async function Ct(n){let t=null;try{t=await D.default.promises.stat(n)}catch(a){}if(t==null||!t.isDirectory())throw new Error("[Package-Deps] Expected packageName to be a readable directory in Node.js invocation");let e=null;try{let a=await D.default.promises.readFile(A.default.join(n,"package.json"),"utf8");e=JSON.parse(a)}catch(a){}let r=e==null||typeof e!="object"?[]:e["package-deps"];return Array.isArray(r)?r:[]}async function $t(n){var t;let e=A.default.join((t=process.env.ATOM_HOME)!==null&&t!==void 0?t:A.default.join(q.default.homedir(),".atom"),"packages",n);try{return await D.default.promises.access(e,D.default.constants.R_OK),e}catch(r){return null}}async function At(n){var t,e;let{directory:r}=n;if(r==null)return null;let a=null;try{a=JSON.parse(await D.default.promises.readFile(A.default.join(r,"package.json"),"utf8"))}catch(i){return null}return(t=(e=a)===null||e===void 0?void 0:e.version)!==null&&t!==void 0?t:null}async function jt(n){if(E){let t=await Tt(n);if(t)return t}return At(n)}var Z=E?Dt:$t;function P(n,t){if(!n)throw new Error(t??"Invariant violation")}async function Mt(n){let t=await(E?It(n):Ct(n));return kt&&(P(Array.isArray(t),`Dependencies for ${n} are not a valid array`),t.forEach((e,r)=>{if(Array.isArray(e))e.forEach((a,i)=>{let o=`Dependency#${r}#${i} for ${n} is invalid`;P(typeof a.name=="string"&&a.name.length>0,o),P(a.minimumVersion==null||typeof a.minimumVersion=="string"&&a.minimumVersion.length>0,o)}),P(e.length>0,`Dependency#${r} for ${n} has no group items`);else{let a=`Dependency#${r} for ${n} is invalid`;P(typeof e.name=="string"&&e.name.length>0,a),P(e.minimumVersion==null||typeof e.minimumVersion=="string"&&e.minimumVersion.length>0,a)}})),t}async function ee(n){if(n.directory==null)return!0;if(n.minimumVersion==null)return!1;let t=await jt(n);return t==null?!0:St(n.minimumVersion,t)===1}function Ot(n){var t;return E?!!((t=atom.config.get(F))!==null&&t!==void 0?t:[]).includes(n):!1}function Lt(n){var t;if(!E)return;let e=new Set((t=atom.config.get(F))!==null&&t!==void 0?t:[]);e.add(n),atom.config.set(F,Array.from(e))}var qt=new Set(["\u2713","done"]),Ft=/(?:Installing|Moving) (.*?) to .* (.*)/;async function Vt(n){let t=E?`"${atom.packages.getApmPath()}"`:"apm",{stdout:e,stderr:r}=await _t(t,["install",n.name,"--production","--color","false"],{shell:!0}),a=Ft.exec(e.trim());if(a!=null&&qt.has(a[2]))return;let i=new Error(`Error installing dependency: ${n.name}`);throw i.stack=r.trim(),i}async function te(n){if(typeof n=="string")return{name:n,directory:await Z(n)};if("name"in n)return{...n,directory:await Z(n.name)};throw console.error("This package-deps entry is not valid. Please see https://github.com/steelbrain/package-deps#how-it-works",{entry:n}),Error("The package-deps entry is not valid. Please see https://github.com/steelbrain/package-deps#how-it-works")}var ne=!0;function Nt({packageName:n,dependencies:t}){return new Promise(e=>{let r=t.filter(c=>!Array.isArray(c)),a=t.filter(c=>Array.isArray(c)),i=a.length===0,o=i?r.map(c=>c.name).join(", "):"Something went wrong. Check your developer console",l=a.map(c=>c[0]);atom.packages.isPackageDisabled("notifications")&&console.warn(`Enable notifications to install dependencies for ${n}`);let u=atom.notifications.addInfo(`${n} needs to install dependencies`,{dismissable:!0,icon:"cloud-download",detail:o,description:`Install dependenc${t.length===1?"y":"ies"}?`,buttons:[{text:"Yes",onDidClick:()=>{e(i?r:r.concat(l)),u.dismiss()}},{text:"No Thanks",onDidClick:()=>{u.dismiss()}},{text:"Never",onDidClick:()=>{Lt(n),ne&&(ne=!1,atom.notifications.addInfo("How to reset package-deps memory",{dismissable:!0,description:"To modify the list of ignored files invoke 'Application: Open Your Config' and change the 'atom-package-deps' section"})),u.dismiss()}}]});if(u.onDidDismiss(()=>e([])),!i)try{var s;let c=atom.views.getView(u),f=(s=c==null?void 0:c.element)!==null&&s!==void 0?s:null;if(f==null)throw new Error("Unable to get notification element from view");let d=f.querySelector(".detail-content");if(d==null)throw new Error("Content detail container not found inside the notification");if(d.innerHTML="",r.length>0){let h=document.createElement("div");h.innerHTML=`Packages without choices: <br /><ul><li>${r.map(y=>Q(y.name)).join("</li><li>")}</li></ul>`,d.appendChild(h)}let p=document.createElement("div");p.innerHTML="Packages with choices:",d.appendChild(p);let g=document.createElement("ul");a.forEach((h,y)=>{let O=document.createElement("li"),T=document.createElement("select");T.innerHTML=h.map(C=>`<option>${Q(C.name)}</option>`).join(`
`),T.addEventListener("change",()=>{let C=h.find(qe=>qe.name===T.value);C!=null&&(l[y]=C)}),O.style.marginTop="5px",O.appendChild(T),g.appendChild(O)}),d.appendChild(g)}catch(c){console.error("[Package-Deps] Error during showing package choices to user",c)}})}function Ht({packageName:n,dependencies:t}){let e=[],r=atom.notifications.addInfo(`Installing ${n} dependencies`,{detail:`Installing ${t.map(o=>o.name).join(", ")}`,dismissable:!0}),a=document.createElement("progress");a.max=t.length,a.style.width="100%";try{var i;let o=atom.views.getView(r),l=(i=o==null?void 0:o.element)!==null&&i!==void 0?i:null;if(l==null)throw new Error("Unable to get notification element from view");let u=l.querySelector(".detail-content");if(u==null)throw new Error("Content detail container not found inside the notification");u.appendChild(a)}catch(o){console.error("[Package-Deps] Error during showing installation progress to user",o)}return{handleFailure({dependency:o,error:l}){var u;e.push(o.name),a.value+=1,console.error(`[Package-Deps] Unable to install ${o.name}, Error:`,(u=l==null?void 0:l.stack)!==null&&u!==void 0?u:l)},handleDependencyInstalled(o){a.value+=1},handleComplete(){r.dismiss(),e.length>0?atom.notifications.addWarning(`Failed to install ${n} dependencies`,{detail:`These packages were not installed, check your console
for more info.
${e.join(`
`)}`,dismissable:!0}):atom.notifications.addSuccess(`Installed ${n} dependencies`,{detail:`Installed ${t.map(o=>o.name).join(", ")}`}),Promise.all(t.map(o=>e.includes(o.name)?null:atom.packages.activatePackage(o.name))).catch(o=>{console.error(`[Package-Deps] Error activating installed packages for ${n}`,o)})}}}async function Rt({dependencies:n}){return n.map(t=>Array.isArray(t)?t[0]:t)}function Wt({dependencies:n}){let t=!1;return console.log(`Installing dependencies:
${n.map(e=>`  - ${e.name}`).join(`
`)}`),{handleFailure({dependency:e,error:r}){var a;t=!0,console.error(`Unable to install ${e.name}, Error:`,(a=r==null?void 0:r.stack)!==null&&a!==void 0?a:r)},handleDependencyInstalled(e){console.log("Successfully installed",e.name)},handleComplete(){console.log("Installation complete"),t&&(process.exitCode=1)}}}var Bt=E?Ht:Wt,Gt=E?Nt:Rt;async function Ut(n,t=!1){if(P(typeof n=="string"&&n.length>0,"[Package-Deps] Package name is required"),Ot(n))return;let e=await Mt(n);if(e.length===0)return;let r=await Promise.all(e.map(async l=>Array.isArray(l)?Promise.all(l.map(te)):te(l))),a=await z(r,async function(l){return Array.isArray(l)?(await Promise.all(l.map(u=>ee(u)))).every(Boolean):ee(l)});if(a.length===0)return;let i;if(t?i=a.map(l=>Array.isArray(l)?l[0]:l):i=await Gt({packageName:n,dependencies:a}),i.length===0)return;let o=Bt({packageName:n,dependencies:i});await vt(i,async function(l){try{await Vt(l),o.handleDependencyInstalled(l)}catch(u){o.handleFailure({dependency:l,error:u})}},{concurrency:2}),o.handleComplete()}V.install=Ut});var ie=b((In,N)=>{"use strict";var ae=()=>{let n=Error.prepareStackTrace;Error.prepareStackTrace=(e,r)=>r;let t=new Error().stack.slice(1);return Error.prepareStackTrace=n,t};N.exports=ae;N.exports.default=ae});var oe=b((Dn,se)=>{"use strict";var Jt=ie();se.exports=({depth:n=0}={})=>{let t=[],e=new Set;for(let r of Jt()){let a=r.getFileName(),i=r.getTypeName()!==null&&a!==null;if(e.has(a)||(e.add(a),t.unshift(r)),i)return t[n]}}});var fe=b(v=>{"use strict";var Xt=v&&v.__awaiter||function(n,t,e,r){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(c){try{s(r.next(c))}catch(f){o(f)}}function u(c){try{s(r.throw(c))}catch(f){o(f)}}function s(c){c.done?i(c.value):a(c.value).then(l,u)}s((r=r.apply(n,t||[])).next())})},Yt=v&&v.__generator||function(n,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,a,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(s){return function(c){return u([s,c])}}function u(s){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,a&&(i=s[0]&2?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,a=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){e.label=s[1];break}if(s[0]===6&&e.label<i[1]){e.label=i[1],i=s;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(s);break}i[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(n,e)}catch(c){s=[6,c],a=0}finally{r=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(v,"__esModule",{value:!0});v.readManifestSync=v.readManifest=void 0;var le=require("path"),Kt=le.resolve,zt=le.sep,ce=require("fs"),Qt=ce.promises,Zt=ce.readFileSync,en=oe();function tn(n){return n===void 0&&(n=""),Xt(this,void 0,void 0,function(){var t,e,r;return Yt(this,function(a){switch(a.label){case 0:t=ue(n),a.label=1;case 1:return a.trys.push([1,3,,4]),[4,Qt.readFile(t,"utf8")];case 2:return e=a.sent(),[2,JSON.parse(e)];case 3:return r=a.sent(),[2,null];case 4:return[2]}})})}v.readManifest=tn;function nn(n){n===void 0&&(n="");var t=ue(n);try{var e=Zt(t,"utf8");return JSON.parse(e)}catch(r){return null}}v.readManifestSync=nn;function ue(n){n=(n==null?void 0:n.length)?n:rn();var t=atom.packages.resolvePackagePath(n),e=Kt(t,"package.json");return e}function rn(){var n=en().getFileName(),t=atom.packages.getPackageDirPaths(),e=t.filter(function(r){return n.startsWith(r)});return(e==null?void 0:e.length)&&n.replace(e[0],"").split(zt).filter(function(r){return r})[0]||""}});var de=b(w=>{"use strict";var j=w&&w.__assign||function(){return j=Object.assign||function(n){for(var t,e=1,r=arguments.length;e<r;e++){t=arguments[e];for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a])}return n},j.apply(this,arguments)},an=w&&w.__awaiter||function(n,t,e,r){function a(i){return i instanceof e?i:new e(function(o){o(i)})}return new(e||(e=Promise))(function(i,o){function l(c){try{s(r.next(c))}catch(f){o(f)}}function u(c){try{s(r.throw(c))}catch(f){o(f)}}function s(c){c.done?i(c.value):a(c.value).then(l,u)}s((r=r.apply(n,t||[])).next())})},sn=w&&w.__generator||function(n,t){var e={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},r,a,i,o;return o={next:l(0),throw:l(1),return:l(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function l(s){return function(c){return u([s,c])}}function u(s){if(r)throw new TypeError("Generator is already executing.");for(;e;)try{if(r=1,a&&(i=s[0]&2?a.return:s[0]?a.throw||((i=a.return)&&i.call(a),0):a.next)&&!(i=i.call(a,s[1])).done)return i;switch(a=0,i&&(s=[s[0]&2,i.value]),s[0]){case 0:case 1:i=s;break;case 4:return e.label++,{value:s[1],done:!1};case 5:e.label++,a=s[1],s=[0];continue;case 7:s=e.ops.pop(),e.trys.pop();continue;default:if(i=e.trys,!(i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){e=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){e.label=s[1];break}if(s[0]===6&&e.label<i[1]){e.label=i[1],i=s;break}if(i&&e.label<i[2]){e.label=i[2],e.ops.push(s);break}i[2]&&e.ops.pop(),e.trys.pop();continue}s=t.call(n,e)}catch(c){s=[6,c],a=0}finally{r=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:!0}}};Object.defineProperty(w,"__esModule",{value:!0});w.satisfyDependencies=void 0;var on=re(),ln=fe(),cn={logger:console.log};function un(n,t){return t===void 0&&(t={}),an(this,void 0,void 0,function(){var e,r;return sn(this,function(a){switch(a.label){case 0:return e=j(j({},cn),t),[4,ln.readManifest(n)];case 1:return r=a.sent(),[4,on.install(r.name)];case 2:return a.sent(),fn(r["package-deps"],e),[2]}})})}w.satisfyDependencies=un;function fn(n,t){t.enableDependencies&&n["package-deps"].map(function(e){atom.packages.isPackageDisabled(e)&&(atom.inDevMode()&&t.logger("["+n.name+"] Enabling package dependency '"+e+"'"),atom.packages.enablePackage(e))})}});var we=b((On,ve)=>{ve.exports=ye;ye.sync=gn;var he=require("fs");function pn(n,t){var e=t.pathExt!==void 0?t.pathExt:process.env.PATHEXT;if(!e||(e=e.split(";"),e.indexOf("")!==-1))return!0;for(var r=0;r<e.length;r++){var a=e[r].toLowerCase();if(a&&n.substr(-a.length).toLowerCase()===a)return!0}return!1}function me(n,t,e){return!n.isSymbolicLink()&&!n.isFile()?!1:pn(t,e)}function ye(n,t,e){he.stat(n,function(r,a){e(r,r?!1:me(a,n,t))})}function gn(n,t){return me(he.statSync(n),n,t)}});var xe=b((Ln,Pe)=>{Pe.exports=ke;ke.sync=hn;var be=require("fs");function ke(n,t,e){be.stat(n,function(r,a){e(r,r?!1:Ee(a,t))})}function hn(n,t){return Ee(be.statSync(n),t)}function Ee(n,t){return n.isFile()&&mn(n,t)}function mn(n,t){var e=n.mode,r=n.uid,a=n.gid,i=t.uid!==void 0?t.uid:process.getuid&&process.getuid(),o=t.gid!==void 0?t.gid:process.getgid&&process.getgid(),l=parseInt("100",8),u=parseInt("010",8),s=parseInt("001",8),c=l|u,f=e&s||e&u&&a===o||e&l&&r===i||e&c&&i===0;return f}});var Se=b((Fn,_e)=>{var qn=require("fs"),M;process.platform==="win32"||global.TESTING_WINDOWS?M=we():M=xe();_e.exports=H;H.sync=yn;function H(n,t,e){if(typeof t=="function"&&(e=t,t={}),!e){if(typeof Promise!="function")throw new TypeError("callback not provided");return new Promise(function(r,a){H(n,t||{},function(i,o){i?a(i):r(o)})})}M(n,t||{},function(r,a){r&&(r.code==="EACCES"||t&&t.ignoreErrors)&&(r=null,a=!1),e(r,a)})}function yn(n,t){try{return M.sync(n,t||{})}catch(e){if(t&&t.ignoreErrors||e.code==="EACCES")return!1;throw e}}});var je=b((Vn,Ae)=>{var S=process.platform==="win32"||process.env.OSTYPE==="cygwin"||process.env.OSTYPE==="msys",Ie=require("path"),vn=S?";":":",De=Se(),Te=n=>Object.assign(new Error(`not found: ${n}`),{code:"ENOENT"}),Ce=(n,t)=>{let e=t.colon||vn,r=n.match(/\//)||S&&n.match(/\\/)?[""]:[...S?[process.cwd()]:[],...(t.path||process.env.PATH||"").split(e)],a=S?t.pathExt||process.env.PATHEXT||".EXE;.CMD;.BAT;.COM":"",i=S?a.split(e):[""];return S&&n.indexOf(".")!==-1&&i[0]!==""&&i.unshift(""),{pathEnv:r,pathExt:i,pathExtExe:a}},$e=(n,t,e)=>{typeof t=="function"&&(e=t,t={}),t||(t={});let{pathEnv:r,pathExt:a,pathExtExe:i}=Ce(n,t),o=[],l=s=>new Promise((c,f)=>{if(s===r.length)return t.all&&o.length?c(o):f(Te(n));let d=r[s],p=/^".*"$/.test(d)?d.slice(1,-1):d,g=Ie.join(p,n),h=!p&&/^\.[\\\/]/.test(n)?n.slice(0,2)+g:g;c(u(h,s,0))}),u=(s,c,f)=>new Promise((d,p)=>{if(f===a.length)return d(l(c+1));let g=a[f];De(s+g,{pathExt:i},(h,y)=>{if(!h&&y)if(t.all)o.push(s+g);else return d(s+g);return d(u(s,c,f+1))})});return e?l(0).then(s=>e(null,s),e):l(0)},wn=(n,t)=>{t=t||{};let{pathEnv:e,pathExt:r,pathExtExe:a}=Ce(n,t),i=[];for(let o=0;o<e.length;o++){let l=e[o],u=/^".*"$/.test(l)?l.slice(1,-1):l,s=Ie.join(u,n),c=!u&&/^\.[\\\/]/.test(n)?n.slice(0,2)+s:s;for(let f=0;f<r.length;f++){let d=c+r[f];try{if(De.sync(d,{pathExt:a}))if(t.all)i.push(d);else return d}catch(p){}}}if(t.all&&i.length)return i;if(t.nothrow)return null;throw Te(n)};Ae.exports=$e;$e.sync=wn});B(exports);We(exports,{activate:()=>kn,config:()=>G,provideBuilder:()=>bn});var Ge="build-pynsist",Ue="0.5.2",Je="Atom Build provider for Pynsist, builds Windows installers for Python applications",Xe="https://github.com/idleberg/atom-build-pynsist",Ye="MIT OR GPL-2.0",Ke={build:"node ./tools/build.mjs",clean:"rimraf ./lib",dev:"npm run start","lint:md":"remark . --quiet --frail --ignore-path .gitignore","lint:js":"eslint ./src --ignore-path .gitignore",lint:"npm-run-all --parallel lint:*",start:"cross-env ESBUILD_WATCH=true node ./tools/build.mjs",test:"npm run lint"},ze=["buildprovider","compile","pynsist","nsis","windows","installer"],Qe="lib/provider.js",Ze={atom:">=1.0.0 <2.0.0"},et=["core:loaded-shell-environment"],tt={builder:{description:"Compiles NSIS installers",versions:{"2.0.0":"provideBuilder"}}},nt=[[{name:"buildium"},{name:"build"}]],rt={},at={"@atxm/developer-console":"^0.5.0","@babel/core":"^7.14.3","@babel/eslint-parser":"^7.14.3","@babel/plugin-proposal-optional-chaining":"^7.14.2","atom-package-deps":"^7.2.3","atom-satisfy-dependencies":"^0.3.0","cross-env":"^7.0.3",esbuild:"^0.12.1",eslint:"^7.26.0","eslint-plugin-json":"^3.0.0",husky:">=4 <5","lint-staged":"^11.0.0","log-symbols":"^5.0.0","npm-run-all":"^4.1.5","remark-cli":"^9.0.0",rimraf:"^3.0.2",which:"^2.0.2"},it={hooks:{"pre-commit":"lint-staged"}},st={"*.js":"eslint --cache --fix"},ot={node:"14.17.0",yarn:"1.22.10"},k={name:Ge,version:Ue,description:Je,repository:Xe,license:Ye,scripts:Ke,keywords:ze,main:Qe,engines:Ze,activationHooks:et,providedServices:tt,"package-deps":nt,dependencies:rt,devDependencies:at,husky:it,"lint-staged":st,volta:ot};var G={pathToPynsist:{title:"Path to Pynsist",description:"Specify the full path to `pynsist`",type:"string",default:"pynsist",order:0},mutePathWarning:{title:"Mute Warning",description:"When enabled, warnings about missing path to `pynsist` will be muted",type:"boolean",default:!1,order:1},manageDependencies:{title:"Manage Dependencies",description:"When enabled, third-party dependencies will be installed automatically",type:"boolean",default:!0,order:3},alwaysEligible:{title:"Always Eligible",description:"The build provider will be available in your project, even when not eligible",type:"boolean",default:!1,order:4}};function x(n){return atom.config.get(`${k.name}.${n}`)}var Me=I(require("events")),R=I(require("fs")),W=I(require("path")),Oe=I(de());function _(n,t){for(var e=0,r=t.length,a=n.length;e<r;e++,a++)n[a]=t[e];return n}var dn=function(){function n(t){t===void 0&&(t={}),this.name=t.name,this.styleSheet=`
      background-color: `+(t.backgroundColor||"darkgrey")+`;
      border-radius: 2px;
      color: `+(t.color||"white")+`;
      line-height: 1.5;
      padding: 1px 4px;
      text-shadow: 0 1px 0px rgba(0, 0, 0, 0.2);
    `}return n.prototype.__console__=function(t){for(var e,r=[],a=1;a<arguments.length;a++)r[a-1]=arguments[a];!(atom==null?void 0:atom.inDevMode())||(r.unshift("%c"+this.name+"%c",this.styleSheet,""),(e=window.console)[t].apply(e,r))},n.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.__console__.apply(this,_(["debug"],t))},n.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.__console__.apply(this,_(["error"],t))},n.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.__console__.apply(this,_(["info"],t))},n.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.__console__.apply(this,_(["log"],t))},n.prototype.trace=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.__console__.apply(this,_(["trace"],t))},n.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.__console__.apply(this,_(["warn"],t))},n}(),pe=dn;var ge=new pe({name:k.name,backgroundColor:"rosybrown"});var Le=I(je());function bn(){return class extends Me.EventEmitter{constructor(t){super();this.cwd=t,atom.config.observe("build-pynsist.pathToPynsist",()=>this.emit("refresh"))}getNiceName(){return"Pynsist"}async isEligible(){if(x("alwaysEligible")===!0)return ge.log("Always eligible"),!0;let t=atom.project.getPaths()[0],e=typeof t!="undefined"?(0,R.existsSync)((0,W.join)(t,"installer.cfg")):!1,r=atom.workspace.getActiveTextEditor(),a=typeof r!="undefined"?r.getPath():!1,i=a!==!1?(0,R.existsSync)((0,W.join)(a,"installer.cfg")):!1,o=!!(e||i),l=x("pathToPynsist"),u=Boolean(Le.default.sync(l,{nothrow:!0}));if(u===!0&&o===!0)return!0;if(u===!1&&x("mutePathWarning")===!1){let s=atom.notifications.addWarning(`**${k.name}**: No valid \`pynsist\` was specified in your settings`,{dismissable:!0,buttons:[{text:"Open Settings",className:"icon icon-gear",onDidClick:function(){atom.workspace.open(`atom://config/packages/${k.name}`,{pending:!0,searchAllPanes:!0}),s.dismiss()}},{text:"Ignore",onDidClick:function(){atom.config.set(`${k.name}.mutePathWarning`,!0),s.dismiss()}}]})}return!1}settings(){let t=x("pathToPynsist");return[{name:"Pynsist: Compile Installer",exec:t,args:["{FILE_ACTIVE}"],cwd:"{FILE_ACTIVE_PATH}",sh:!1,keymap:"cmd-alt-b"},{name:"Pynsist: Generate Script",exec:t,args:["--no-makensis","{FILE_ACTIVE}"],cwd:"{FILE_ACTIVE_PATH}",sh:!1,keymap:"cmd-alt-b"}]}}}async function kn(){x("manageDependencies")===!0&&(0,Oe.satisfyDependencies)(k.name)}0&&(module.exports={activate,config,provideBuilder});
/*!
 * escape-html
 * Copyright(c) 2012-2013 TJ Holowaychuk
 * Copyright(c) 2015 Andreas Lubbe
 * Copyright(c) 2015 Tiancheng "Timothy" Gu
 * MIT Licensed
 */
/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */
//# sourceMappingURL=provider.js.map
